{"ast":null,"code":"import React from'react';import SplashPage from'./components/SplashPage';import QuestionPrompt from'./components/QuestionPrompt';import AnswerForm from'./components/AnswerForm';import{useState,useEffect,useCallback,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[page,setPage]=useState(0);const[question,setQuestion]=useState({prompt:'Loading...',correctAnswer:'',studentAnswer:''});const tokenRef=useRef(new URLSearchParams(window.location.search).get('t'));const[message,setMessage]=useState('');useEffect(()=>{if(tokenRef.current===null){setMessage('You must launch this app from the assignment link in your LMS.');}},[]);useEffect(()=>{const timer=setTimeout(()=>{if(message===\"\")setPage(1);},3000);return()=>clearTimeout(timer);},[message]);const getQuestion=async()=>{try{if(!tokenRef.current){throw new Error('No token found');}const response=await fetch('/question?token='+tokenRef.current,{method:'GET',headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}});if(!response.ok){throw new Error('Failed to fetch question');}const data=await response.json();tokenRef.current=data.token;setQuestion(data.question);console.log('Fetched:',question.prompt);}catch(error){console.error('Error fetching question:',error);setMessage('Error fetching question');setPage(0);}};const submitAnswer=useCallback(async()=>{if(!question.studentAnswer)return;try{const response=await fetch('/answer?token='+tokenRef.current,{method:'POST',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error('Failed to fetch question');}const data=await response.json();tokenRef.current=data.token;setQuestion(data.question);console.log('Fetched:',question.prompt);}catch(error){console.error('Error submitting answer:',error);setMessage('Error submitting answer');}},[question.studentAnswer]);// Fetch the first question when the app loads\nuseEffect(()=>{getQuestion();},[getQuestion]);return/*#__PURE__*/_jsxs(\"div\",{children:[page===0&&/*#__PURE__*/_jsx(SplashPage,{message:message}),page>0&&/*#__PURE__*/_jsx(QuestionPrompt,{question:question}),page===1&&/*#__PURE__*/_jsx(AnswerForm,{submitAnswer:submitAnswer})]});};export default App;","map":{"version":3,"names":["React","SplashPage","QuestionPrompt","AnswerForm","useState","useEffect","useCallback","useRef","jsx","_jsx","jsxs","_jsxs","App","page","setPage","question","setQuestion","prompt","correctAnswer","studentAnswer","tokenRef","URLSearchParams","window","location","search","get","message","setMessage","current","timer","setTimeout","clearTimeout","getQuestion","Error","response","fetch","method","headers","ok","data","json","token","console","log","error","submitAnswer","children"],"sources":["/Users/wight/JS Programs/chem4ap_react/src/App.tsx"],"sourcesContent":["import React from 'react';\nimport SplashPage from './components/SplashPage';\nimport QuestionPrompt from './components/QuestionPrompt';\nimport AnswerForm from './components/AnswerForm';\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\ninterface Question {\n  prompt: string;\n  correctAnswer: string;\n  studentAnswer: string;\n}\n\nconst App: React.FC = () => {\n  const [page, setPage] = useState(0);\n  const [question, setQuestion] = useState<Question>({\n    prompt: 'Loading...',\n    correctAnswer: '',\n    studentAnswer: ''\n  });\n  const tokenRef = useRef<string | null>(new URLSearchParams(window.location.search).get('t'));\n  const [message, setMessage] = useState<string>('');\n  \n  useEffect(() => {\n    if (tokenRef.current === null) {\n      setMessage('You must launch this app from the assignment link in your LMS.');\n    }\n  }, []);\n  \n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (message===\"\") setPage(1);\n    }, 3000);\n    return () => clearTimeout(timer);\n  }, [message]);\n\n  const getQuestion = async () => {\n    try {\n      if (!tokenRef.current) {\n        throw new Error('No token found');\n      }\n      const response = await fetch('/question?token=' + tokenRef.current, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      });\n      if (!response.ok) {\n        throw new Error('Failed to fetch question');\n      }\n      const data = await response.json();\n      tokenRef.current = data.token;\n      setQuestion(data.question);\n      console.log('Fetched:', question.prompt);\n    } catch (error) {\n      console.error('Error fetching question:', error);\n      setMessage('Error fetching question');\n      setPage(0)\n    }\n  };\n  \n  const submitAnswer = useCallback(async () => {\n    if (!question.studentAnswer) return;\n    try {\n      const response = await fetch('/answer?token=' + tokenRef.current, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        }\n      });\n      if (!response.ok) {\n        throw new Error('Failed to fetch question');\n      }\n      const data = await response.json();\n      tokenRef.current = data.token;\n      setQuestion(data.question);\n      console.log('Fetched:', question.prompt);\n    } catch (error) {\n      console.error('Error submitting answer:', error);\n      setMessage('Error submitting answer');\n    }\n  }, [question.studentAnswer]);\n\n  // Fetch the first question when the app loads\n  useEffect(() => {\n    getQuestion();\n  }, [getQuestion]);\n\n  return (\n    <div>\n      {page === 0 && <SplashPage message={message} />}\n      {page > 0 && <QuestionPrompt question={question} />}\n      {page === 1 && <AnswerForm submitAnswer={submitAnswer} />}\n    </div>\n  );\n};\n\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,UAAU,KAAM,yBAAyB,CAChD,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,UAAU,KAAM,yBAAyB,CAChD,OAASC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,CAAEC,MAAM,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAQjE,KAAM,CAAAC,GAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,CAAC,CAAC,CACnC,KAAM,CAACW,QAAQ,CAAEC,WAAW,CAAC,CAAGZ,QAAQ,CAAW,CACjDa,MAAM,CAAE,YAAY,CACpBC,aAAa,CAAE,EAAE,CACjBC,aAAa,CAAE,EACjB,CAAC,CAAC,CACF,KAAM,CAAAC,QAAQ,CAAGb,MAAM,CAAgB,GAAI,CAAAc,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAAC,CAC5F,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGvB,QAAQ,CAAS,EAAE,CAAC,CAElDC,SAAS,CAAC,IAAM,CACd,GAAIe,QAAQ,CAACQ,OAAO,GAAK,IAAI,CAAE,CAC7BD,UAAU,CAAC,gEAAgE,CAAC,CAC9E,CACF,CAAC,CAAE,EAAE,CAAC,CAENtB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,KAAK,CAAGC,UAAU,CAAC,IAAM,CAC7B,GAAIJ,OAAO,GAAG,EAAE,CAAEZ,OAAO,CAAC,CAAC,CAAC,CAC9B,CAAC,CAAE,IAAI,CAAC,CACR,MAAO,IAAMiB,YAAY,CAACF,KAAK,CAAC,CAClC,CAAC,CAAE,CAACH,OAAO,CAAC,CAAC,CAEb,KAAM,CAAAM,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,GAAI,CAACZ,QAAQ,CAACQ,OAAO,CAAE,CACrB,KAAM,IAAI,CAAAK,KAAK,CAAC,gBAAgB,CAAC,CACnC,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,kBAAkB,CAAGf,QAAQ,CAACQ,OAAO,CAAE,CAClEQ,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,6BAA6B,CAAE,GACjC,CACF,CAAC,CAAC,CACF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAL,KAAK,CAAC,0BAA0B,CAAC,CAC7C,CACA,KAAM,CAAAM,IAAI,CAAG,KAAM,CAAAL,QAAQ,CAACM,IAAI,CAAC,CAAC,CAClCpB,QAAQ,CAACQ,OAAO,CAAGW,IAAI,CAACE,KAAK,CAC7BzB,WAAW,CAACuB,IAAI,CAACxB,QAAQ,CAAC,CAC1B2B,OAAO,CAACC,GAAG,CAAC,UAAU,CAAE5B,QAAQ,CAACE,MAAM,CAAC,CAC1C,CAAE,MAAO2B,KAAK,CAAE,CACdF,OAAO,CAACE,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDjB,UAAU,CAAC,yBAAyB,CAAC,CACrCb,OAAO,CAAC,CAAC,CAAC,CACZ,CACF,CAAC,CAED,KAAM,CAAA+B,YAAY,CAAGvC,WAAW,CAAC,SAAY,CAC3C,GAAI,CAACS,QAAQ,CAACI,aAAa,CAAE,OAC7B,GAAI,CACF,KAAM,CAAAe,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,gBAAgB,CAAGf,QAAQ,CAACQ,OAAO,CAAE,CAChEQ,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CACF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAL,KAAK,CAAC,0BAA0B,CAAC,CAC7C,CACA,KAAM,CAAAM,IAAI,CAAG,KAAM,CAAAL,QAAQ,CAACM,IAAI,CAAC,CAAC,CAClCpB,QAAQ,CAACQ,OAAO,CAAGW,IAAI,CAACE,KAAK,CAC7BzB,WAAW,CAACuB,IAAI,CAACxB,QAAQ,CAAC,CAC1B2B,OAAO,CAACC,GAAG,CAAC,UAAU,CAAE5B,QAAQ,CAACE,MAAM,CAAC,CAC1C,CAAE,MAAO2B,KAAK,CAAE,CACdF,OAAO,CAACE,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDjB,UAAU,CAAC,yBAAyB,CAAC,CACvC,CACF,CAAC,CAAE,CAACZ,QAAQ,CAACI,aAAa,CAAC,CAAC,CAE5B;AACAd,SAAS,CAAC,IAAM,CACd2B,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,CAACA,WAAW,CAAC,CAAC,CAEjB,mBACErB,KAAA,QAAAmC,QAAA,EACGjC,IAAI,GAAK,CAAC,eAAIJ,IAAA,CAACR,UAAU,EAACyB,OAAO,CAAEA,OAAQ,CAAE,CAAC,CAC9Cb,IAAI,CAAG,CAAC,eAAIJ,IAAA,CAACP,cAAc,EAACa,QAAQ,CAAEA,QAAS,CAAE,CAAC,CAClDF,IAAI,GAAK,CAAC,eAAIJ,IAAA,CAACN,UAAU,EAAC0C,YAAY,CAAEA,YAAa,CAAE,CAAC,EACtD,CAAC,CAEV,CAAC,CAED,cAAe,CAAAjC,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module"}