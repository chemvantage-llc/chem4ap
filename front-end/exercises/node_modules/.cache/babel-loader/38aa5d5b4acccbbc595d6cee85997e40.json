{"ast":null,"code":"import React from'react';import SplashPage from'./components/SplashPage';import QuestionPrompt from'./components/QuestionPrompt';import AnswerForm from'./components/AnswerForm';import{useState,useEffect,useRef,useCallback}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[page,setPage]=useState(0);const[question,setQuestion]=useState({id:0,parameter:0,prompt:'',correctAnswer:'',studentAnswer:''});const[message,setMessage]=useState('');const tokenRef=useRef(null);useEffect(()=>{const urlParams=new URLSearchParams(window.location.search);const token=urlParams.get('t');if(token){tokenRef.current=token;}else{setMessage('No token found in URL. Please launch this app from your LMS');}},[]);useEffect(()=>{if(message!==\"\"){setPage(0);return;}const timer=setTimeout(()=>{setPage(1);},3000);return()=>clearTimeout(timer);},[message]);const getQuestion=useCallback(async()=>{if(page!==1)return;try{if(!tokenRef.current){throw new Error('No token found. Please launch this app from your LMS');}const response=await fetch('/question?token='+tokenRef.current,{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+tokenRef.current}});if(!response.ok){throw new Error('The one-time token was invalid. Please launch this app from your LMS');}const data=await response.json();if(data.token!==null)tokenRef.current=data.token;if(data.question!==null)setQuestion(data.question);console.log('Fetched a question');}catch(error){console.error('Error fetching question:',error);if(error instanceof Error){setMessage(error.message);}else{setMessage('An unknown error occurred');}}},[page]);// Fetch the first question when the app loads\nuseEffect(()=>{getQuestion();},[getQuestion]);return/*#__PURE__*/_jsxs(\"div\",{children:[page===0&&/*#__PURE__*/_jsx(SplashPage,{message:message}),page>0&&question.prompt&&/*#__PURE__*/_jsx(QuestionPrompt,{question:question}),page>0&&question.prompt&&/*#__PURE__*/_jsx(AnswerForm,{tokenRef:tokenRef,question:question,page:page,setPage:setPage})]});};export default App;","map":{"version":3,"names":["React","SplashPage","QuestionPrompt","AnswerForm","useState","useEffect","useRef","useCallback","jsx","_jsx","jsxs","_jsxs","App","page","setPage","question","setQuestion","id","parameter","prompt","correctAnswer","studentAnswer","message","setMessage","tokenRef","urlParams","URLSearchParams","window","location","search","token","get","current","timer","setTimeout","clearTimeout","getQuestion","Error","response","fetch","method","headers","ok","data","json","console","log","error","children"],"sources":["/Users/wight/JS Programs/chem4ap_react/src/App.tsx"],"sourcesContent":["import React from 'react';\nimport SplashPage from './components/SplashPage';\nimport QuestionPrompt from './components/QuestionPrompt';\nimport AnswerForm from './components/AnswerForm';\nimport { useState, useEffect, useRef, useCallback } from 'react';\n\ninterface Question {\n  id: number;\n  parameter: number\n  prompt: string;\n  correctAnswer: string;\n  studentAnswer: string;\n}\n\nconst App: React.FC = () => {\n  const [page, setPage] = useState(0);\n  const [question, setQuestion] = useState<Question>({\n    id: 0,\n    parameter: 0,\n    prompt: '',\n    correctAnswer: '',\n    studentAnswer: ''\n  });\n  const [message, setMessage] = useState<string>('');\n  const tokenRef = useRef<string | null>(null);\nuseEffect(() => {\n  const urlParams = new URLSearchParams(window.location.search);\n  const token = urlParams.get('t');\n  if (token) {\n    tokenRef.current = token;\n  } else {\n    setMessage('No token found in URL. Please launch this app from your LMS');\n  }\n}, []);\n  useEffect(() => {\n    if (message !== \"\") {\n      setPage(0);\n      return;\n    }\n    const timer = setTimeout(() => {\n      setPage(1);\n    }, 3000);\n    return () => clearTimeout(timer);\n  }, [message]);\n\n  const getQuestion = useCallback(async () => {\n    if (page !== 1) return;\n    try {\n      if (!tokenRef.current) {\n        throw new Error('No token found. Please launch this app from your LMS');\n      }\n      const response = await fetch('/question?token=' + tokenRef.current, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + tokenRef.current\n        }\n      });\n      if (!response.ok) {\n        throw new Error('The one-time token was invalid. Please launch this app from your LMS');\n      }\n      const data = await response.json();\n      if (data.token !== null) tokenRef.current = data.token;\n      if (data.question !== null) setQuestion(data.question);\n      console.log('Fetched a question');\n    } catch (error) {\n      console.error('Error fetching question:', error);\n      if (error instanceof Error) {\n        setMessage(error.message);\n      } else {\n        setMessage('An unknown error occurred');\n      }\n    }\n  }, [page]);\n\n  // Fetch the first question when the app loads\n  useEffect(() => {\n    getQuestion();\n  }, [getQuestion]);\n\n  return (\n    <div>\n      {page === 0 && <SplashPage message={message} />}\n      {page > 0 && question.prompt && <QuestionPrompt question={question} />}\n      {page > 0 && question.prompt && <AnswerForm tokenRef={tokenRef} question={question} page={page} setPage={setPage} />}\n    </div>\n  );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}